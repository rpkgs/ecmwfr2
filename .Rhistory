devtools::load_all(".")
# library(httr)
# library(curlR)
library(ecmwfr)
varnames = c(
'evaporation_from_bare_soil',
'evaporation_from_open_water_surfaces_excluding_oceans',
'evaporation_from_the_top_of_canopy',
'evaporation_from_vegetation_transpiration',
'potential_evaporation',
'snow_evaporation',
'runoff',
'sub_surface_runoff',
'surface_runoff',
'total_evaporation')
varname = "runoff"
years = 2020
request_ERA5(varname, years, transfer = FALSE, ds = "reanalysis-era5-land-monthly-means")
rm_empty
is_empty
Ipaper::is_empty
devtools::load_all(".")
varnames = c(
# 'evaporation_from_bare_soil',
# 'evaporation_from_open_water_surfaces_excluding_oceans',
# 'evaporation_from_the_top_of_canopy',
# 'evaporation_from_vegetation_transpiration',
# 'potential_evaporation',
# 'snow_evaporation',
# 'runoff',
'sub_surface_runoff',
'surface_runoff',
'total_evaporation')
devtools::load_all(".")
{
lst_years <- list(1981:1989, 1990:1999, 2000:2009, 2010:2019, 2020)
for (varname in varnames) {
for (years in lst_years) {
request_ERA5(varname, years, transfer = FALSE, ds = "reanalysis-era5-land-monthly-means")
}
devtools::load_all(".")
varnames = c(
'evaporation_from_bare_soil',
'evaporation_from_open_water_surfaces_excluding_oceans',
'evaporation_from_the_top_of_canopy',
'evaporation_from_vegetation_transpiration',
'potential_evaporation',
'snow_evaporation',
'runoff',
'sub_surface_runoff',
'surface_runoff',
'total_evaporation')
varnames = c(
'evaporation_from_bare_soil',
'evaporation_from_open_water_surfaces_excluding_oceans',
'evaporation_from_the_top_of_canopy',
'evaporation_from_vegetation_transpiration',
'potential_evaporation',
'snow_evaporation',
'runoff',
'sub_surface_runoff',
'surface_runoff',
'total_evaporation')[1:2]
{
lst_years <- list(1981:1989, 1990:1999, 2000:2009, 2010:2019, 2020)
for (varname in varnames) {
for (years in lst_years) {
request_ERA5(varname, years, transfer = FALSE, ds = "reanalysis-era5-land-monthly-means")
}
varnames = c(
'evaporation_from_bare_soil',
'evaporation_from_open_water_surfaces_excluding_oceans',
'evaporation_from_the_top_of_canopy',
'evaporation_from_vegetation_transpiration',
'potential_evaporation',
'snow_evaporation',
'runoff',
'sub_surface_runoff',
'surface_runoff',
'total_evaporation')
60*40
library(raster)
brick("I:/ERA5L/ERA5Land_ET_1981-01-01.tif") %>% plot()
b = brick("I:/ERA5L/ERA5Land_ET_1981-01-01.tif") #%>% plot()
names(b)
plot(b[[-(7:9)]])
plot(b[[-(7:9)]]*-1000)
write_fig({
plot(b[[-(7:9)]]*-1000)
}, "a.pdf", 10, 6)
24*30
write_fig({
plot(b[[-(7:9)]]*-1000*24*30)
}, "a.pdf", 10, 6)
document()
code()
library(rgdal)
GDALinfo("H:/ERA5_runoff/cems-glofas-historical_2019.grib")
r = readGDAL("H:/ERA5_runoff/cems-glofas-historical_2019.grib")
GDALinfo("H:/ERA5_runoff/cems-glofas-historical_2019.grib2")
GDALinfo("H:/ERA5_runoff/cems-glofas-historical_2019.grib")
GDALinfo("H:/ERA5_runoff/cems-glofas-historical_1981.grib")
x = GDALinfo("H:/ERA5_runoff/cems-glofas-historical_1981.grib")
x
GDALinfo("H:/ERA5_runoff/cems-glofas-historical_2017.grib")
GDALinfo("H:/ERA5_runoff/cems-glofas-historical_2018.grib")
GDALinfo("H:/ERA5_runoff/cems-glofas-historical_2019.grib")
x = brick("H:/ERA5_runoff/cems-glofas-historical_2018.grib")
library(raster)
x = brick("H:/ERA5_runoff/cems-glofas-historical_2018.grib")
x = brick("H:/ERA5_runoff/cems-glofas-historical_1979.grib")
x
plot(x[[1:4]])
x = brick("H:/ERA5_runoff/cems-glofas-historical_192017.grib")
x = brick("H:/ERA5_runoff/cems-glofas-historical_2017.grib")
library(latticeMap)
r <- rgdal::readGDAL("H:/ERA5_runoff/cems-glofas-historical_lisflood-v3.1_1993.tif")
write_fig(spplot(r[, 1:2]), "a.pdf", 10, 5)
library(sp)
libr
library(latticeMap)
write_fig(spplot(r[, 1:2]), "a.pdf", 10, 5)
coordinates(r)
coordinates(r) %>% summary()
{
p <- spplot(r[, 1:2])
write_fig(p, "a.pdf", 10, 5)
}
write_fig(p, "a.pdf", 20, 5)
write_fig(p, "a.pdf", 5, 5)
{
p <- spplot(r)
write_fig(p, "a.pdf", 5, 5)
}
r[, 1:2]
r[[1:2]]
{
p <- spplot(r, 1:2)
write_fig(p, "a.pdf", 10, 5)
}
g <- r[[1]]
g <- r[, 1]
g <- r %>% select(1)
g <- r[, 1:2]
coordinates(g)
g <- r[,,1:2]
{
p <- sp_plot(g, 1:2)
write_fig(p, "a.pdf", 10, 5)
}
{
p <- sp_plot(g)
write_fig(p, "a.pdf", 10, 5)
}
library(nctools)
nc_date("F:/CUG-Hydro/ecmwfr2/grib/runoff.nc")
nc_info("F:/CUG-Hydro/ecmwfr2/grib/runoff.nc")
nc_date("F:/CUG-Hydro/ecmwfr2/grib/runoff.nc")
r = raster("F:/CUG-Hydro/ecmwfr2/grib/runoff.nc")
library(raster)
r = raster("F:/CUG-Hydro/ecmwfr2/grib/runoff.nc")
plot(r)
library(nctools)
nc_info("H:/ERA5_runoff/1979.nc")
nc_date("H:/ERA5_runoff/1979.nc")
dir()
code()
devtools::load_all(".")
code()
library(humidity)
install.packages("humidity")
devtools::load_all(".")
wf_set_key(
user = "12106",
key = "faa165eb-2d80-4843-9c80-2d5e90adf977",
service = "cds"
)
# wf_set_key(user = "kongdd@mail2.sysu.edu.cn",
#            key = "f436eb66ece8fb12140f1b22a0c14c06",
#            service = "webapi")
library(ecmwfr)
wf_set_key(
user = "12106",
key = "faa165eb-2d80-4843-9c80-2d5e90adf977",
service = "cds"
)
devtools::load_all(".")
{
# 50, 30, 20
varnames <- c(
'2m_temperature',
"2m_dewpoint_temperature",
"surface_pressure"
# 'v_component_of_wind',
# "u_component_of_wind",
# "divergence", "vorticity"
# 'geopotential',
# 'relative_humidity',
# 'specific_humidity'
)
lst_years <- list(1979:1989, 1990:1999, 2000:2009, 2010:2020)
for (varname in varnames) {
for (years in lst_years) {
request_hourly(varname, years, transfer = FALSE)
}
devtools::load_all(".")
{
# 50, 30, 20
varnames <- c(
# '2m_temperature',
# "2m_dewpoint_temperature",
"surface_pressure"
# 'v_component_of_wind',
# "u_component_of_wind",
# "divergence", "vorticity"
# 'geopotential',
# 'relative_humidity',
# 'specific_humidity'
)
lst_years <- list(1979:1989, 1990:1999, 2000:2009, 2010:2020)
for (varname in varnames) {
for (years in lst_years) {
request_hourly(varname, years,
ds = "reanalysis-era5-single-levels",
transfer = FALSE)
}
devtools::load_all(".")
{
# 50, 30, 20
varnames <- c(
# '2m_temperature',
# "2m_dewpoint_temperature",
"surface_pressure"
# 'v_component_of_wind',
# "u_component_of_wind",
# "divergence", "vorticity"
# 'geopotential',
# 'relative_humidity',
# 'specific_humidity'
)
lst_years <- list(1979:1989, 1990:1999, 2000:2009, 2010:2020)
for (varname in varnames) {
for (years in lst_years) {
request_hourly(varname, years,
ds = "reanalysis-era5-single-levels", product_type = "reanalysis",
transfer = FALSE)
}
devtools::load_all(".")
{
# 50, 30, 20
varnames <- c(
# '2m_temperature',
# "2m_dewpoint_temperature",
"surface_pressure"
# 'v_component_of_wind',
# "u_component_of_wind",
# "divergence", "vorticity"
# 'geopotential',
# 'relative_humidity',
# 'specific_humidity'
)
lst_years <- list(1979:1989, 1990:1999, 2000:2009, 2010:2020)
for (varname in varnames) {
for (years in lst_years) {
request_hourly(varname, years,
ds = "reanalysis-era5-single-levels", product_type = "reanalysis",
transfer = FALSE)
}
devtools::load_all(".")
{
# 50, 30, 20
varnames <- c(
'2m_temperature',
"2m_dewpoint_temperature",
"surface_pressure"
# 'v_component_of_wind',
# "u_component_of_wind",
# "divergence", "vorticity"
# 'geopotential',
# 'relative_humidity',
# 'specific_humidity'
)
lst_years <- list(1979:1989, 1990:1999, 2000:2009, 2010:2020)
for (varname in varnames[1:2]) {
for (years in lst_years) {
request_hourly(varname, years,
ds = "reanalysis-era5-single-levels", product_type = "reanalysis",
transfer = FALSE)
}
devtools::load_all(".")
Ipaper::chunk
Ipaper::chunk(1979:2020)
Ipaper::chunk(1979:2020, 4)
lst_years <- Ipaper::chunk(1979:2020, 4)
lst_years
